name: è‡ªåŠ¨æ›´æ–°æ˜Ÿæ ‡é¡¹ç›®

on:
  schedule:
    - cron: '0 0 * * *'  # æ¯å¤© UTC æ—¶é—´ 0 ç‚¹è¿è¡Œ
  workflow_dispatch:

permissions:
  contents: write  # ğŸ‘ˆ å…è®¸å†™å…¥ä»“åº“å†…å®¹

jobs:
  update-readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout ä»“åº“
        uses: actions/checkout@v3

      - name: è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: å®‰è£…ä¾èµ–
        run: pip install PyGithub

      - name: è¿è¡Œè„šæœ¬
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
        run: python update_readme.py

      - name: æäº¤å¹¶æ¨é€æ›´æ–°
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
        run: |
          git config --global user.name "ä½ çš„GitHubç”¨æˆ·å"
          git config --global user.email "ä½ çš„GitHubé‚®ç®±"
          git remote set-url origin https://x-access-token:${GH_PAT}@github.com/${{ github.repository }}
          git add README.md
          git commit -m "è‡ªåŠ¨æ›´æ–°æ˜Ÿæ ‡é¡¹ç›®åˆ—è¡¨" || echo "æ²¡æœ‰å˜æ›´"
          git push origin HEAD:${{ github.ref_name }}
